{% extends 'base.html' %}

{% block content %}
<h1>All Blogs</h1>

{% for blog in blogs %}
    <h2>{{ blog.title }}</h2>
    <p>{{ blog.content }}</p>
    <p>By {{ blog.author.username }}</p>

    <!-- LIKE BUTTON -->
    <form method="POST" action="{% url 'like_blog' blog.id %}">
        {% csrf_token %}
        {% if user in blog.likes.all %}
            <button>‚ù§Ô∏è</button>
        {% else %}
            <button>ü§ç</button>
        {% endif %}
    </form>

    <p>{{ blog.total_likes }} Likes</p>

    {% if user == blog.author %}
        <a class="edit-btn" href="{% url 'edit_blog' blog.id %}">Edit</a>
        <a class="delete-btn" href="{% url 'delete_blog' blog.id %}">Delete</a>
    {% endif %}

    <!-- COMMENTS SECTION -->
    <h4>Comments</h4>

    {% for comment in blog.comments.all %}
        <p>
            <b>{{ comment.user.username }}</b>:
            {{ comment.text }}
        </p>
    {% empty %}
        <p>No comments yet.</p>
    {% endfor %}

    {% if user.is_authenticated %}
    <form method="POST" action="{% url 'add_comment' blog.id %}">
        {% csrf_token %}
        <input type="text" name="comment" placeholder="Add comment" required>
        <button type="submit">Post</button>
    </form>
    {% endif %}

    <hr>
{% endfor %}

{% endblock %}

